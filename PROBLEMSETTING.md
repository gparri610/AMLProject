# Proposal Advanced Machine Learning Semester Project
### Filippo Tomelleri - Sean Boos - Giovanni Parri - Said Haji Abukar

## Introduction
Our semester project will be based on this <a href = "https://arxiv.org/abs/2112.08534">preprint</a>.
The core idea of our project is to use transformers to predict intraday financial time series using order book and closing auction information. Next to benchmark models including an LSTM model, a vanilla transformer and a Random Forrest model we will implement the transoformer architecture described in the mentioned preprint and a modified version of said architecture. The authors used various transformer based architectures to develop trading strategies with daily data. They found that their final model outperformed benchmarks when measured with risk adjusted return metrics such as the Sharpe Ratio. One of their key finding was that the combination of Recurrent Neural Network layers and attention mechanisms can improve results for financial time series prediction problems. 
In our project we will asses whether this success can be replicated with intraday prices as the targets and order book and closing auction information as features.
This problem is a very relevant issue for market makers such as Optiver. These firms are tasked with posting bid and ask quotes to ensure liquidity and orderly markets, accurate predictions of closing prices are crucial. The ability to forecast these prices impacts their risk management and inventory control towards the end of the trading day when price movements can be more volatile and unpredictable.

In this project we will implement a model based on the LSTM-Transformer hybird architecture proposed in the preprint but with Convolutional Layers instead of the Gated Residual Network Layers. We hypothesize that the reduction of the number of parameters stemming from this change may potentialy result in a more robust architecture. Given the noisiness of financial time series data we further hypothesize that this may lead to better prediction performance.

## Formal Problem Setting
Given a sequence of intraday financial data up to time $t$, our objective is to predict the relative price movements of stocks at the closing auction using order book and closing auction information. Formally, we define the problem as follows: The objective is to find a predictive model $f$, which, given the observable data $X_t$ up to time $t$, minimizes the mean squared error (MSE) between the predicted relative price movement $\hat{y}_{t+1}$ at time $t+1$ and the actual relative price movements $y_{t+1}$. The predicted relative price movement  $\hat{y}_{t+1}$ is given by the function $f(X_t; \theta)$, where $f$ is parametrized by the parameter set $\theta$.

In our setup, $X_t$ represents the limit order book and auction data at time $t$, and the filtration $\mathcal{F}_t$ contains all the information generated by $X_t$ up to time $t$. Formally, the filtration $\mathcal{F}_t$ is the $\sigma$-algebra generated by the stochastic process $X_t$, i.e., $\mathcal{F}_t = \sigma(\{X_s : 0 \leq s \leq t\})$.

The predictive model $f$ is adapted to the filtration $\mathcal{F}_t$, ensuring that predictions at time $t$ only utilize information up to that point. The problem objective, considering the set containing the time indices of the test data denoted by $S$, can then be defined as:

$\hat{y}_{t+1} = f(X_t; \theta)$

$\underset{\theta, f}{argmin} \quad \mathbb{E}\left[\left(y_{t+1} - \hat{y}_{t+1}\right)^2 \middle| \mathcal{F}_t\right] \quad \forall t \in S$ 

This formalization ensures that the predictive model uses only the information available up to time $t$ and is evaluated based on its ability to accurately predict future prices given information up to that point.

## Evaluation Protocol
Our project uses a comparative approach to evaluate the different models. As mentioned above, we will implement benchmark models such as an LSTM model, a vanilla transformer and a Random Forrest model. We will also implement the LSTM-Transformer architecture proposed in the preprint and a modified version of this architecture using Convolutional Layers. While the authors of the preprint focus on risk-adjusted return metrics such as the sortino ratio, we focus on more traditional regression metrics, namely the mean squared error. This comes from the fact that in our given setting we foucs on the market makers perspective. In our given setup the price of an asset is less well defined as we have a bid and ask price and related volume. To run a backtest we would have to consider a specified volume and also the market impact of our trading. This would unecesarily complicate things and distort our results which should be purely focused on analyzing the ability of the given models to predict intraday financial time series at the close. This is why are using the mean squared error as evaluation metric. 

For the validation phase we will use predefined testing data that the models will not have seen in training to calculate the mean squared error. We will use the same data to train, and validate, all the models to enable comparisions. In splitting our dataset into training and test sets, we ensure there's no forward-looking bias by methodically allocating the most recent 20% of the data as test data, without any shuffling, to maintain the chronological integrity and relevance of our analysis.

## Tuning of hyperparameters
The various models we will implement have various parameters. To ensure a systematic tunig of the hyperparameters we will use random grid search as proposed in the preprint. The values of the hyperparameter grid will be based on values that have been established as reasonable in the literature.

## Data
We are using the data set from the kaggle competition <a href = "https://www.kaggle.com/competitions/optiver-trading-at-the-close">"Optiver - Trading at the Close"</a>. The data set contains historic data for the daily ten minute closing auction on the NASDAQ stock exchange. The features are order book and auction data for stocks and the labels are future price movements of these stocks relative to a synthetic index containing all NASDAQ listed stocks.


